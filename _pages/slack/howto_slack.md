---
title:          How-to use SMS/Texto alerting system
layout:         single
date_created:   2021-03-16
date_updated:   2021-03-16 
limit:          1
paginate:       false
show_excerpts:  false
entries_layout: list
author_profile: true
tags:           slack alert scripts
categories:     alert
toc:            true
---

## Configuring the SMS alerting system

1- Get a 'Textbelt' key from the Textbelt web site.  
2- Setup Textbelt in SADMIN configuration file.  
3- Defining cellular number and sms alert group.  
3- Set the default alerting group.  
3- Changing the default alerting group.  
3- Override the default alert group and type in a script.  
3- Override the default alert group in SADMIN System Monitor.  
3- Testing SMS/Texto alert.

 
## Getting a 'Textbelt' key

Go to the [Textbelt web site](https://textbelt.com).  
To get a Textbelt key, click on the “Generate my key” button.  
![BrokenImage](/assets/img/slack/textbelt_web_part1.png)  

The textbelt key will be associated with your email address, you need to enter it at this point.  
![BrokenImage](/assets/img/slack/textbelt_web_part2.png)  

The price to use their service is reasonable, for $20 you can send up to 600 SMS messages.  
You can using your credit card or use Paypal to checkout.  
![BrokenImage](/assets/img/slack/textbelt_web_part3.png)  



## Setup Textbelt in SADMIN configuration file

* Now that we have our 'Textbelt' key, we need to put it into the SADMIN configuration file (sadmin.cfg).  
* Using your favorite editor open ‘$SADMIN/cfg/sadmin.cfg’.  
```bash
# vi $SADMIN/cfg/sadmin.cfg
#----------------------------------------------------------------------------
# TEXTBELT SMS TEXT MESSAGE VARIABLE
# This is the key generated by TextBelt and the URL to use the SMS Service
# Go to https://textbelt.com/ and press the 'Generate my key' button.
# Enter your email address and decide what is the right plan for you.
# It's $10 for 250 Text Messages, $20 for 600, $40 for 1200.
#----------------------------------------------------------------------------
SADM_TEXTBELT_KEY = 12b0f573dfc4e1377471dc930684dfbcdded045eiSw1swtuyrUyRxHTJX2vAFhdxs
SADM_TEXTBELT_URL = https://textbelt.com/text
```

    You need to update two fields :  
    **SADM_TEXTBELT_KEY**  
        This field contain the textbelt key that was previously generated for you.  
        To eliminate any typo error, use the clipboard copy/paste to enter the key.  

    **SADM_TEXTBELT_URL**  
        It's the URL use by SADMIN to send the SMS request to Textbelt web site.  
        SADMIN is using the ‘curl’ linux command to issue the request to textbelt.  


## Defining cellular number and sms alert group  
  
**Cellular group definition**

* You need to declare what are the cellular number that can receive SADMIN alert.  
* In column one, we give the cellular number a name, it can be the cellular owner name or cellular purpose (like support,on_call,...).  
* On the definition line, we need to have the name, the cellular group type ('c') and finally the telephone number.  

**SMS/Texto group definition**  

* If you need to alert more than one person (cellular) when an alert is issue, you can use the SMS/Texto group to do so.  
* You declare the SMS/Texto group, like 'webteam', 'telecom', 'sysadmin', that include multiple cellular definition.  
* In the example below, the SMS/Texto group 'emergency', will send the alert to four cellulars.  

With your favorite editor open ‘alert-group’ file and define your own cellular and SMS/Texto group.  

`# vi $SADMIN/cfg/alert_group.cfg   `

![BrokenImage](/assets/img/slack/textbelt_web_part4.png)  


## Setting the default alerting group

* When an alert is issue from a script or from the SADMISystem Monitor, it is sent to an alert group.
* The default alert group name used is the one specified ithe SADMIN configuration file (See image below).
* The 'SADM_ALERT_GROUP' name doesn't have to be 'default', icould be any of the group define in the alert group file.
* You can change the 'SADM_ALERT_GROUP' name with youfavorite editor whenever you need to.
* The group name you specify, MUST exist in the Alert Groufile ($SADMIN/cfg/alert_group.cfg).
* You may also leave it to 'default' and change the definition of the 'default' group in the alert group file.

![BrokenImage](/assets/img/slack/default_alert_group_in_sadmincfg.png)  


<br>

## Changing the default alerting group

* If SMS/Texto is your preferred way to get alerted, change the definition o* the default alert group.
* Here, we change the 'default' group definition to have a group type 't* (Texto) and to use alert group 'sysadmin_sms'.
* This means that by default, all alert will be sent to group 'sysadmin_sms* which contain one cellular definition 'john_doe'
* So all alert will be sent to John Doe cellular, if you don't override it i* your script or in system monitor configuration file.
* Remember, each group name must begin in column one, be unique and must no* contain any space.

With your favorite editor open the alert group file.   

`# vi $SADMIN/cfg/alert_group.cfg`   

```
# Default Alert Group (It should not be changed or deleted).
# 1st column : Group Name : 'default' 
# 2nd column : Group Type : [s]=SlackChannel [m]=Email [c]=Cell.Number [t]=TextoGroup
# 3nd column : Group Value: Value depend on the group type (See description below)
#default             c   5147577706
#default             s   sadm_prod
#default             m   batman@batcave.com,robin@batcave.com
default             t   sysadmin_sms
 
# Cellular number of individual 
# 1st column : Name you give to identify the cellular number (No space ingroup name).
# 2nd column : 'c' specify that the line is a cellular definition.
# 3th column : Actual cellular number used to send the alert.
# Only one cell. number must be specify, if you want more use SMS(Text) alertgroup
john_doe            c   5147577706
robert_smith        c   4187570067
support_cell        c   5147570068
jerry_calder        c   5147779302
diane_watson        c   5147779303

# SMS(Text) Alert Group (group cellular number together to form a SMSAlert Group.)
# 1st column : SMS (Texto) group name (No space in group name)
# 2nd column : 't' specifying that the line is a SMS (Texto) group definition.
# 3th column : Cellular name previously defined used to send the alert.
# If more than one is specified, they must be separated by comma & no space between
sysadmin_sms        t   john_doe  
emergency_sms       t   john_doe,support_cell,robert_smith,diane_watson
webteam_sms	        t   diane_watson
```


